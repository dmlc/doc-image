2020-01-20 04:32:05,757 - root - INFO - Namespace(accumulate=None, attention_dropout=0.1, batch_size=32, dataset='126gb', dev_batch_size=32, dropout=0.1, early_stop=None, epochs=3, epsilon=1e-06, gpu=2, log_interval=10, lr=3e-05, lr_decay='linear', max_len=128, model_name='xlnet_cased_l12_h768_a12', model_parameters=None, only_inference=False, optimizer='Adam', output_dir='./output_dir', pad=True, seed=51, task_name='MRPC', training_steps=800, warmup_ratio=0.25)
2020-01-20 04:32:14,564 - root - INFO - processing dataset...
2020-01-20 04:32:17,057 - root - INFO - Now we are doing XLNet classification training on [gpu(0), gpu(1)]!
2020-01-20 04:32:17,063 - root - INFO - training steps=800
2020-01-20 04:32:28,419 - root - INFO - Time cost for the first forward-backward =11.35s
2020-01-20 04:32:31,681 - root - INFO - [Epoch 1 Batch 10/120] loss=0.7010, lr=0.0000013
2020-01-20 04:32:34,877 - root - INFO - [Epoch 1 Batch 20/120] loss=0.6508, lr=0.0000028
2020-01-20 04:32:37,774 - root - INFO - [Epoch 1 Batch 30/120] loss=0.6617, lr=0.0000043
2020-01-20 04:32:40,525 - root - INFO - [Epoch 1 Batch 40/120] loss=0.5895, lr=0.0000058
2020-01-20 04:32:43,438 - root - INFO - [Epoch 1 Batch 50/120] loss=0.5957, lr=0.0000073
2020-01-20 04:32:46,389 - root - INFO - [Epoch 1 Batch 60/120] loss=0.5756, lr=0.0000088
2020-01-20 04:32:49,444 - root - INFO - [Epoch 1 Batch 70/120] loss=0.5274, lr=0.0000104
2020-01-20 04:32:52,668 - root - INFO - [Epoch 1 Batch 80/120] loss=0.5913, lr=0.0000119
2020-01-20 04:32:55,411 - root - INFO - [Epoch 1 Batch 90/120] loss=0.5861, lr=0.0000134
2020-01-20 04:32:58,516 - root - INFO - [Epoch 1 Batch 100/120] loss=0.5430, lr=0.0000149
2020-01-20 04:33:01,396 - root - INFO - [Epoch 1 Batch 110/120] loss=0.5239, lr=0.0000164
2020-01-20 04:33:04,272 - root - INFO - [Epoch 1 Batch 120/120] loss=0.5362, lr=0.0000179
2020-01-20 04:33:04,273 - root - INFO - Now we are doing evaluation on dev with [gpu(0), gpu(1)].
2020-01-20 04:33:05,282 - root - INFO - [Batch 10/13] loss=0.5075
2020-01-20 04:33:05,580 - root - INFO - validation metrics:accuracy:0.7549,f1:0.8438
2020-01-20 04:33:05,580 - root - INFO - Time cost=1.31s, throughput=318.18 samples/s
2020-01-20 04:33:07,037 - root - INFO - params saved in: ./output_dir/model_xlnet_MRPC_0.params
2020-01-20 04:33:07,039 - root - INFO - Time cost=49.97s
2020-01-20 04:33:10,023 - root - INFO - [Epoch 2 Batch 10/120] loss=0.4478, lr=0.0000193
2020-01-20 04:33:12,981 - root - INFO - [Epoch 2 Batch 20/120] loss=0.4624, lr=0.0000209
2020-01-20 04:33:15,665 - root - INFO - [Epoch 2 Batch 30/120] loss=0.4199, lr=0.0000224
2020-01-20 04:33:18,340 - root - INFO - [Epoch 2 Batch 40/120] loss=0.5620, lr=0.0000239
2020-01-20 04:33:21,258 - root - INFO - [Epoch 2 Batch 50/120] loss=0.4575, lr=0.0000253
2020-01-20 04:33:24,012 - root - INFO - [Epoch 2 Batch 60/120] loss=0.4155, lr=0.0000268
2020-01-20 04:33:27,114 - root - INFO - [Epoch 2 Batch 70/120] loss=0.3610, lr=0.0000284
2020-01-20 04:33:30,107 - root - INFO - [Epoch 2 Batch 80/120] loss=0.5063, lr=0.0000299
2020-01-20 04:33:32,945 - root - INFO - [Epoch 2 Batch 90/120] loss=0.4248, lr=0.0000295
2020-01-20 04:33:35,977 - root - INFO - [Epoch 2 Batch 100/120] loss=0.4482, lr=0.0000291
2020-01-20 04:33:38,948 - root - INFO - [Epoch 2 Batch 110/120] loss=0.3698, lr=0.0000285
2020-01-20 04:33:41,841 - root - INFO - [Epoch 2 Batch 120/120] loss=0.4211, lr=0.0000281
2020-01-20 04:33:41,842 - root - INFO - Now we are doing evaluation on dev with [gpu(0), gpu(1)].
2020-01-20 04:33:42,863 - root - INFO - [Batch 10/13] loss=0.3125
2020-01-20 04:33:43,143 - root - INFO - validation metrics:accuracy:0.8529,f1:0.8872
2020-01-20 04:33:43,143 - root - INFO - Time cost=1.30s, throughput=319.69 samples/s
2020-01-20 04:33:44,519 - root - INFO - params saved in: ./output_dir/model_xlnet_MRPC_1.params
2020-01-20 04:33:44,520 - root - INFO - Time cost=37.48s
2020-01-20 04:33:47,896 - root - INFO - [Epoch 3 Batch 10/120] loss=0.2777, lr=0.0000276
2020-01-20 04:33:50,738 - root - INFO - [Epoch 3 Batch 20/120] loss=0.2523, lr=0.0000271
2020-01-20 04:33:53,711 - root - INFO - [Epoch 3 Batch 30/120] loss=0.2616, lr=0.0000266
2020-01-20 04:33:56,688 - root - INFO - [Epoch 3 Batch 40/120] loss=0.3185, lr=0.0000261
2020-01-20 04:33:59,556 - root - INFO - [Epoch 3 Batch 50/120] loss=0.3239, lr=0.0000256
2020-01-20 04:34:02,411 - root - INFO - [Epoch 3 Batch 60/120] loss=0.3055, lr=0.0000250
2020-01-20 04:34:05,575 - root - INFO - [Epoch 3 Batch 70/120] loss=0.3016, lr=0.0000246
2020-01-20 04:34:08,389 - root - INFO - [Epoch 3 Batch 80/120] loss=0.3411, lr=0.0000241
2020-01-20 04:34:11,346 - root - INFO - [Epoch 3 Batch 90/120] loss=0.3171, lr=0.0000235
2020-01-20 04:34:14,147 - root - INFO - [Epoch 3 Batch 100/120] loss=0.2830, lr=0.0000231
2020-01-20 04:34:17,151 - root - INFO - [Epoch 3 Batch 110/120] loss=0.3488, lr=0.0000225
2020-01-20 04:34:20,090 - root - INFO - [Epoch 3 Batch 120/120] loss=0.3041, lr=0.0000221
2020-01-20 04:34:20,090 - root - INFO - Now we are doing evaluation on dev with [gpu(0), gpu(1)].
2020-01-20 04:34:21,096 - root - INFO - [Batch 10/13] loss=0.2855
2020-01-20 04:34:21,376 - root - INFO - validation metrics:accuracy:0.8775,f1:0.9113
2020-01-20 04:34:21,376 - root - INFO - Time cost=1.29s, throughput=323.50 samples/s
2020-01-20 04:34:22,931 - root - INFO - params saved in: ./output_dir/model_xlnet_MRPC_2.params
2020-01-20 04:34:22,932 - root - INFO - Time cost=38.41s
2020-01-20 04:34:26,253 - root - INFO - [Epoch 4 Batch 10/120] loss=0.1179, lr=0.0000216
2020-01-20 04:34:29,087 - root - INFO - [Epoch 4 Batch 20/120] loss=0.1728, lr=0.0000211
2020-01-20 04:34:32,066 - root - INFO - [Epoch 4 Batch 30/120] loss=0.1296, lr=0.0000205
2020-01-20 04:34:35,335 - root - INFO - [Epoch 4 Batch 40/120] loss=0.1950, lr=0.0000200
2020-01-20 04:34:38,261 - root - INFO - [Epoch 4 Batch 50/120] loss=0.1741, lr=0.0000196
2020-01-20 04:34:40,944 - root - INFO - [Epoch 4 Batch 60/120] loss=0.2439, lr=0.0000191
2020-01-20 04:34:43,779 - root - INFO - [Epoch 4 Batch 70/120] loss=0.1014, lr=0.0000186
2020-01-20 04:34:46,710 - root - INFO - [Epoch 4 Batch 80/120] loss=0.2032, lr=0.0000181
2020-01-20 04:34:49,695 - root - INFO - [Epoch 4 Batch 90/120] loss=0.1450, lr=0.0000175
2020-01-20 04:34:52,537 - root - INFO - [Epoch 4 Batch 100/120] loss=0.1638, lr=0.0000171
2020-01-20 04:34:55,529 - root - INFO - [Epoch 4 Batch 110/120] loss=0.2269, lr=0.0000166
2020-01-20 04:34:58,403 - root - INFO - [Epoch 4 Batch 120/120] loss=0.3026, lr=0.0000161
2020-01-20 04:34:58,403 - root - INFO - Now we are doing evaluation on dev with [gpu(0), gpu(1)].
2020-01-20 04:34:59,398 - root - INFO - [Batch 10/13] loss=0.3886
2020-01-20 04:34:59,679 - root - INFO - validation metrics:accuracy:0.8701,f1:0.8990
2020-01-20 04:34:59,679 - root - INFO - Time cost=1.28s, throughput=326.04 samples/s
2020-01-20 04:35:01,151 - root - INFO - params saved in: ./output_dir/model_xlnet_MRPC_3.params
2020-01-20 04:35:01,152 - root - INFO - Time cost=38.22s
2020-01-20 04:35:04,165 - root - INFO - [Epoch 5 Batch 10/120] loss=0.1650, lr=0.0000155
2020-01-20 04:35:07,001 - root - INFO - [Epoch 5 Batch 20/120] loss=0.1271, lr=0.0000150
2020-01-20 04:35:09,943 - root - INFO - [Epoch 5 Batch 30/120] loss=0.0726, lr=0.0000146
2020-01-20 04:35:13,130 - root - INFO - [Epoch 5 Batch 40/120] loss=0.0918, lr=0.0000141
2020-01-20 04:35:16,076 - root - INFO - [Epoch 5 Batch 50/120] loss=0.0941, lr=0.0000136
2020-01-20 04:35:18,839 - root - INFO - [Epoch 5 Batch 60/120] loss=0.1442, lr=0.0000131
2020-01-20 04:35:21,691 - root - INFO - [Epoch 5 Batch 70/120] loss=0.1907, lr=0.0000126
2020-01-20 04:35:24,460 - root - INFO - [Epoch 5 Batch 80/120] loss=0.1868, lr=0.0000120
2020-01-20 04:35:27,629 - root - INFO - [Epoch 5 Batch 90/120] loss=0.0612, lr=0.0000115
2020-01-20 04:35:30,477 - root - INFO - [Epoch 5 Batch 100/120] loss=0.1008, lr=0.0000110
2020-01-20 04:35:33,485 - root - INFO - [Epoch 5 Batch 110/120] loss=0.0587, lr=0.0000106
2020-01-20 04:35:36,489 - root - INFO - [Epoch 5 Batch 120/120] loss=0.0929, lr=0.0000101
2020-01-20 04:35:36,489 - root - INFO - Now we are doing evaluation on dev with [gpu(0), gpu(1)].
2020-01-20 04:35:37,492 - root - INFO - [Batch 10/13] loss=0.5421
2020-01-20 04:35:37,773 - root - INFO - validation metrics:accuracy:0.8701,f1:0.9052
2020-01-20 04:35:37,773 - root - INFO - Time cost=1.28s, throughput=323.89 samples/s
2020-01-20 04:35:39,122 - root - INFO - params saved in: ./output_dir/model_xlnet_MRPC_4.params
2020-01-20 04:35:39,123 - root - INFO - Time cost=37.97s
2020-01-20 04:35:42,010 - root - INFO - [Epoch 6 Batch 10/120] loss=0.0509, lr=0.0000096
2020-01-20 04:35:44,733 - root - INFO - [Epoch 6 Batch 20/120] loss=0.0955, lr=0.0000090
2020-01-20 04:35:47,375 - root - INFO - [Epoch 6 Batch 30/120] loss=0.0547, lr=0.0000086
2020-01-20 04:35:50,092 - root - INFO - [Epoch 6 Batch 40/120] loss=0.0372, lr=0.0000080
2020-01-20 04:35:52,998 - root - INFO - [Epoch 6 Batch 50/120] loss=0.1077, lr=0.0000076
2020-01-20 04:35:55,912 - root - INFO - [Epoch 6 Batch 60/120] loss=0.0382, lr=0.0000070
2020-01-20 04:35:58,807 - root - INFO - [Epoch 6 Batch 70/120] loss=0.0705, lr=0.0000065
2020-01-20 04:36:01,803 - root - INFO - [Epoch 6 Batch 80/120] loss=0.0529, lr=0.0000061
2020-01-20 04:36:04,836 - root - INFO - [Epoch 6 Batch 90/120] loss=0.1305, lr=0.0000056
2020-01-20 04:36:07,729 - root - INFO - [Epoch 6 Batch 100/120] loss=0.0611, lr=0.0000051
2020-01-20 04:36:10,611 - root - INFO - [Epoch 6 Batch 110/120] loss=0.0384, lr=0.0000045
2020-01-20 04:36:13,507 - root - INFO - [Epoch 6 Batch 120/120] loss=0.0758, lr=0.0000041
2020-01-20 04:36:13,507 - root - INFO - Now we are doing evaluation on dev with [gpu(0), gpu(1)].
2020-01-20 04:36:14,503 - root - INFO - [Batch 10/13] loss=0.5960
2020-01-20 04:36:14,781 - root - INFO - validation metrics:accuracy:0.8873,f1:0.9199
2020-01-20 04:36:14,781 - root - INFO - Time cost=1.27s, throughput=326.62 samples/s
2020-01-20 04:36:16,068 - root - INFO - params saved in: ./output_dir/model_xlnet_MRPC_5.params
2020-01-20 04:36:16,068 - root - INFO - Time cost=36.94s
2020-01-20 04:36:18,869 - root - INFO - [Epoch 7 Batch 10/120] loss=0.0527, lr=0.0000035
2020-01-20 04:36:21,721 - root - INFO - [Epoch 7 Batch 20/120] loss=0.0473, lr=0.0000030
2020-01-20 04:36:24,765 - root - INFO - [Epoch 7 Batch 30/120] loss=0.0588, lr=0.0000025
2020-01-20 04:36:27,530 - root - INFO - [Epoch 7 Batch 40/120] loss=0.0159, lr=0.0000021
2020-01-20 04:36:30,596 - root - INFO - [Epoch 7 Batch 50/120] loss=0.0535, lr=0.0000016
2020-01-20 04:36:33,437 - root - INFO - [Epoch 7 Batch 60/120] loss=0.0585, lr=0.0000011
2020-01-20 04:36:36,100 - root - INFO - [Epoch 7 Batch 70/120] loss=0.0432, lr=0.0000005
2020-01-20 04:36:39,152 - root - INFO - [Epoch 7 Batch 80/120] loss=0.0433, lr=0.0000001
2020-01-20 04:36:39,153 - root - INFO - Finish training step: 800
2020-01-20 04:36:39,153 - root - INFO - Now we are doing evaluation on dev with [gpu(0), gpu(1)].
2020-01-20 04:36:40,148 - root - INFO - [Batch 10/13] loss=0.5661
2020-01-20 04:36:40,428 - root - INFO - validation metrics:accuracy:0.8922,f1:0.9220
2020-01-20 04:36:40,428 - root - INFO - Time cost=1.28s, throughput=326.17 samples/s
2020-01-20 04:36:41,772 - root - INFO - params saved in: ./output_dir/model_xlnet_MRPC_6.params
2020-01-20 04:36:41,773 - root - INFO - Time cost=25.70s
2020-01-20 04:36:42,175 - root - INFO - Best model at epoch 7. Validation metrics:accuracy:0.8922,f1:0.9220
2020-01-20 04:36:42,176 - root - INFO - Now we are doing testing on test with [gpu(0), gpu(1)].
2020-01-20 04:36:47,714 - root - INFO - Time cost=5.54s, throughput=312.03 samples/s
